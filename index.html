<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Digital ColdBrew</title>

  <link rel="stylesheet" href="styles.css" />

  <!-- GSAP (we keep available for later animations/sections) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

  <!-- Three.js (reliable CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.152.0/build/three.min.js"></script>

  <!--
    EMBEDDED SHADERS: Putting them in the HTML avoids fetch/MIME issues on GitHub Pages.
    script.js will look here first; if empty it will fall back to fetching .vert/.frag files
  -->
<script id="vertexShader" type="x-shader/x-vertex">
  // Simple fullscreen vertex shader (DO NOT redeclare 'position' — Three.js already provides it)
  #ifdef GL_ES
  precision highp float;
  #endif

  void main() {
    // 'position' is provided by Three.js — use it directly
    gl_Position = vec4(position, 1.0);
  }
</script>


  <script id="fragmentShader" type="x-shader/x-fragment">
precision highp float;

uniform float u_time;
uniform vec2 u_resolution;
uniform vec2 u_mouse;
uniform float u_scroll;

// --- helpers ---
float hash(vec2 p) {
  p = fract(p * vec2(123.34, 456.21));
  p += dot(p, p + 45.32);
  return fract(p.x * p.y);
}

float noise(vec2 p) {
  vec2 i = floor(p);
  vec2 f = fract(p);
  float a = hash(i);
  float b = hash(i + vec2(1.0, 0.0));
  float c = hash(i + vec2(0.0, 1.0));
  float d = hash(i + vec2(1.0, 1.0));
  vec2 u = f * f * (3.0 - 2.0 * f);
  return mix(a, b, u.x) + (c - a) * u.y * (1.0 - u.x) + (d - b) * u.x * u.y;
}

float fbm(vec2 p) {
  float v = 0.0;
  float a = 0.5;
  for (int i = 0; i < 5; i++) {
    v += a * noise(p);
    p *= 2.0;
    a *= 0.5;
  }
  return v;
}

// smooth circular mask (for subtle center darkening)
float circleMask(vec2 uv, vec2 center, float radius) {
  float d = length(uv - center);
  return smoothstep(radius, radius - 0.12, d);
}

void main() {
  vec2 uv = gl_FragCoord.xy / u_resolution.xy;
  vec2 aspectUV = uv;
  aspectUV.x *= u_resolution.x / u_resolution.y; // preserve aspect

  // mouse (fallback to center)
  vec2 mouse = u_mouse;
  if (mouse.x < 0.0001 && mouse.y < 0.0001) {
    mouse = vec2(0.5, 0.5);
  }
  // convert mouse to uv-space (same space as uv)
  vec2 mouseUV = vec2(mouse.x, 1.0 - mouse.y);

  float t = u_time * 0.9;
  float scrollInfluence = clamp(u_scroll * 0.6, 0.0, 1.5);

  // base gentle undulation using fbm
  float baseFlow = fbm((aspectUV * 1.8) + vec2(t * 0.08, -t * 0.06));

  // local ripple from mouse movement
  vec2 diff = aspectUV - mouseUV;
  float dist = length(diff);
  float ripple = sin(dist * 45.0 - t * 6.5) * exp(-dist * 6.5);

  // add a few moving layers for viscosity feel
  float layer1 = fbm((aspectUV * 3.8) + vec2(t * 0.12, -t * 0.09));
  float layer2 = fbm((aspectUV * 6.5) - vec2(t * 0.06, t * 0.03));

  // combine them
  float flow = baseFlow * 0.45 + layer1 * 0.28 + layer2 * 0.15 + ripple * 0.9 + scrollInfluence * 0.25;

  // clamp & smooth
  flow = smoothstep(-0.3, 1.0, flow);

  // coffee color palette
  vec3 cream = vec3(0.96, 0.93, 0.89);     // background warm cream
  vec3 caramel = vec3(0.72, 0.50, 0.34);   // mid coffee
  vec3 espresso = vec3(0.18, 0.09, 0.05);  // deep coffee

  // compute color by blending with flow
  vec3 coffee = mix(caramel, espresso, clamp(flow * 1.2, 0.0, 1.0));
  vec3 background = mix(cream, coffee, 0.18);

  // subtle surface highlight (sheen) — guided by flow + a whisper of noise
  float sheen = (sin((aspectUV.y + t * 0.6) * 25.0) * 0.5 + 0.5) * 0.06;
  float micro = (fbm(aspectUV * 30.0 + t * 2.0) - 0.5) * 0.02;

  // depth/edge darkening using a circular mask to give volume
  float mask = circleMask(aspectUV, vec2(0.5 * (u_resolution.x/u_resolution.y), 0.5), 0.9);
  coffee *= mix(1.0, 0.86, mask * 0.45);

  // final color composition: base background blended with coffee surface and sheen
  vec3 color = mix(background, coffee, flow * 1.05);
  color += sheen * flow;
  color += micro * flow;

  // tiny rim highlight near ripple center
  float rim = exp(-dist * 14.0) * 0.12;
  color += vec3(0.04, 0.02, 0.01) * rim;

  // slight gamma
  color = pow(color, vec3(0.95));

  gl_FragColor = vec4(color, 1.0);
}
  </script>

</head>
<body>

  <!-- Full-page WebGL canvas -->
  <canvas id="coffee-canvas"></canvas>

  <!-- Content above canvas -->
  <header class="nav">
    <div class="brand">Digital <span>ColdBrew</span></div>
    <nav>
      <a href="#home">Home</a>
      <a href="#about">Who we are</a>
      <a href="#services">Services</a>
      <a href="#case">Case Studies</a>
      <a href="#contact">Contact</a>
    </nav>
  </header>

  <main>
    <section id="home" class="hero">
      <h1>Digital ColdBrew</h1>
      <p>Creative production for lifestyle brands — studio, shoots & performance marketing.</p>
    </section>

    <section id="about" class="content">
      <h2>Who we are</h2>
      <p>We craft campaigns that blend creativity, storytelling and measurable performance.</p>
    </section>

    <section id="services" class="content">
      <h2>Services</h2>
      <ul>
        <li>Social Media Marketing</li>
        <li>Brand Strategy</li>
        <li>Product Shoot & Video Production</li>
        <li>Performance Marketing</li>
      </ul>
    </section>

    <section id="case" class="content">
      <h2>Case Studies</h2>
      <p>Coming soon — with real brand campaigns and detailed results.</p>
    </section>

    <section id="contact" class="content">
      <h2>Contact</h2>
      <p>Email: contact@digitalcoldbrew.com</p>
    </section>
  </main>

  <!-- final script: robust loader will use the embedded shaders if present -->
  <script src="script.js"></script>
</body>
</html>
